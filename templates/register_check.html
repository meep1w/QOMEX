<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Проверка трейдер ID</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex,nofollow">

  <link rel="icon" type="image/png" href="static/img/logosite.svg?v=1">
  <link rel="stylesheet" href="/static/register_check.css" />
</head>
<body>
<canvas id="stars"></canvas>

<header class="header">
  <div class="container header-inner">

    <button id="burger" class="burger-btn" aria-label="Открыть меню" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>

    <div class="mobile-menu" id="mobileMenu">
      <button class="close-btn" id="closeMenu" aria-label="Закрыть">×</button>

      {% if request.cookies.get('user_email') %}
      <a href="/profile" class="menu-cta" data-i18n="header_profile">Профиль</a>
      {% else %}
      <a href="/auth" class="menu-cta" data-i18n="header_register">Зарегистрироваться</a>
      {% endif %}

      <nav class="mobile-nav">
        <a href="/go-to-signals" data-i18n="header_signals">Сигналы</a>
        <a href="/#about" data-i18n="header_about">О софте</a>
        <a href="/#advantages" data-i18n="header_risks">Виды риска</a>
        <a href="/#instruction" data-i18n="header_instruction">Инструкция</a>
      </nav>
    </div>

    <a href="/" class="logo-link">
      <img src="static/img/QomexLogo%202.svg" alt="QOMEX Logo" class="logo" />
    </a>

    <nav class="nav">
      <a href="/#about" data-i18n="header_about">О софте</a>
      <a href="/#advantages" data-i18n="header_risks">Виды риска</a>
      <a href="/go-to-signals" data-i18n="header_signals">Сигналы</a>
      <a href="/#instruction" data-i18n="header_instruction">Инструкция</a>
    </nav>

    <div class="header-right">
      {% if request.cookies.get("user_email") %}
      <a href="/profile" class="contact-btn">
        <span data-i18n="header_profile">Профиль</span>
      </a>
      {% else %}
      <a href="/auth" class="contact-btn">
        <span data-i18n="header_register">Зарегистрироваться</span>
      </a>
      {% endif %}
    </div>

    <div class="language-icons">
      <img src="/static/img/ru.svg" alt="RU" class="lang-icon" data-lang="ru">
      <img src="/static/img/en.svg" alt="EN" class="lang-icon" data-lang="en">
      <img src="/static/img/ua.svg" alt="UA" class="lang-icon" data-lang="ua">
    </div>
  </div>
</header>

<!-- CONTENT -->
<div class="container">
  <h1 class="page-title" data-i18n="register_title">Зарегистрируйтесь на PocketOption</h1>
  <p class="page-subtitle" data-i18n="register_subtitle">чтобы мы могли связать ваш аккаунт с системой</p>

  <div class="form-box">
    <h2 class="form-title" data-i18n="check_title">Проверка трейдер ID</h2>

    <form method="post" action="/check">
      <input type="hidden" name="user_id" value="{{ user_id }}" />
      <input type="text" name="trader_id" placeholder="Введите ваш Trader ID" required data-i18n-placeholder="placeholder_trader_id" />
      <button type="submit" class="btn-submit" data-i18n="btn_continue">Продолжить</button>
    </form>

    <a href="{{ ref_link }}" target="_blank" class="btn-secondary" data-i18n="btn_register_pocket">
      Зарегистрироваться на PocketOption
    </a>

    <div class="helper-links">
      <a href="javascript:void(0)" onclick="openPopup('popup-why')" data-i18n="why_register">Для чего нужно зарегистрироваться</a>
      <a href="javascript:void(0)" onclick="openPopup('popup-where')" data-i18n="where_trader_id">Где найти Trader ID</a>
    </div>

    {% if result %}
    <div class="result error">{{ result }}</div>
    {% endif %}
  </div>
</div>

<!-- POPUPS -->
<div class="popup-overlay" id="popup-why">
  <div class="popup-box">
    <span class="popup-close" onclick="closePopup('popup-why')">&times;</span>
    <h2 data-i18n="popup_why_title">Почему нужно зарегистрироваться</h2>
    <p data-i18n="popup_why_text">Регистрация на PocketOption позволяет системе связать сигналы с вашим трейдерским аккаунтом, отслеживать вашу активность и начислять бонусы за активную торговлю.</p>
  </div>
</div>

<div class="popup-overlay" id="popup-where">
  <div class="popup-box">
    <span class="popup-close" onclick="closePopup('popup-where')">&times;</span>
    <h2 data-i18n="popup_where_title">Где найти ваш Trader ID</h2>
    <p data-i18n="popup_where_text">Зайдите в личный кабинет PocketOption, откройте раздел «Профиль». Там вы увидите ваш уникальный Trader ID — он состоит из цифр и букв.</p>
  </div>
</div>

<!-- JS: бургер + закрытие меню и автоскрытие хедера на скролле -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const burger = document.getElementById('burger-button');
    const overlay = document.getElementById('mobile-overlay');

    if (burger && overlay) {
      burger.addEventListener('click', () => {
        const isOpen = overlay.classList.toggle('active');
        burger.setAttribute('aria-expanded', String(isOpen));
      });

      // Закрыть меню по клику на фон или на пункт
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) overlay.classList.remove('active');
      });
      overlay.querySelectorAll('.mobile-nav a, .mobile-btn').forEach(a => {
        a.addEventListener('click', () => overlay.classList.remove('active'));
      });
    }

    // Автоскрытие хедера при скролле вниз на мобилке
    let last = 0;
    const header = document.querySelector('.header');
    window.addEventListener('scroll', () => {
      if (window.innerWidth <= 768 && header) {
        const y = window.scrollY || document.documentElement.scrollTop;
        if (y > last) header.style.transform = 'translateY(-100%)';
        else header.style.transform = 'translateY(0)';
        last = y <= 0 ? 0 : y;
      }
    });
  });
</script>

<script src="/static/js/check.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const burger = document.getElementById('burger');
    const menu   = document.getElementById('mobileMenu');
    const close  = document.getElementById('closeMenu');

    // создаём/используем backdrop
    let backdrop = document.querySelector('.menu-backdrop');
    if (!backdrop) {
      backdrop = document.createElement('div');
      backdrop.className = 'menu-backdrop';
      document.body.appendChild(backdrop);
    }

    // если меню вдруг оказалось внутри header — вынесем в body
    if (menu && menu.parentElement !== document.body) {
      document.body.appendChild(menu);
    }

    const openMenu  = () => {
      menu.classList.add('show');
      backdrop.classList.add('show');
      burger?.classList.add('active');
      burger?.setAttribute('aria-expanded', 'true');
      document.body.style.overflow = 'hidden';
    };
    const closeMenu = () => {
      menu.classList.remove('show');
      backdrop.classList.remove('show');
      burger?.classList.remove('active');
      burger?.setAttribute('aria-expanded', 'false');
      document.body.style.overflow = '';
    };

    burger?.addEventListener('click', () => {
      const opened = menu.classList.contains('show');
      opened ? closeMenu() : openMenu();
    });
    close?.addEventListener('click', closeMenu);
    backdrop.addEventListener('click', closeMenu);
    menu.querySelectorAll('a').forEach(a => a.addEventListener('click', closeMenu));
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeMenu(); });
  });
</script>

</body>
</html>
